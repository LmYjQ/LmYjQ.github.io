---
layout:     post
title:      MIR
subtitle:   Music Information Retrieval
date:       2019-03-22
author:     LmYjQ
header-img: img/MIR_head.jpg
catalog: true
tags:
    - MIR
    - Deep Learning
---

> è¯‘è‡ª [ã€ŠA Tutorial on Deep Learning for Music Information Retrievalã€‹](https://arxiv.org/pdf/1709.04396.pdf)

### ç›®å½•

- 1.åŠ¨æœºï¼ˆç•¥ï¼‰
- 2.æ·±åº¦å­¦ä¹ åŸºç¡€
- 3.MIRä»»åŠ¡ä»‹ç»
- 4.æ ¸å¿ƒæ¨¡å—
- 5.è¾…åŠ©æ¨¡å—
- 6.æ€»ç»“

### 2. æ·±åº¦å­¦ä¹ åŸºç¡€

> **BP+SGDæ±‚è§£ç¥ç»ç½‘ç»œï¼›CNNæå–ç‰¹å¾ï¼ŒLSTMé’ˆå¯¹åºåˆ—æ•°æ®ï¼›Reluæ¿€æ´»å‡½æ•°**

#### 2.1 æ·±åº¦å­¦ä¹ å’Œ"ä¼ ç»Ÿ"æ–¹æ³•å¯¹æ¯”
ä¼ ç»Ÿï¼š è¾“å…¥->ç‰¹å¾æå–ï¼ˆMFCCï¼‰->åˆ†ç±»å™¨->ç»“æœ  
æ·±åº¦å­¦ä¹ ï¼šè¾“å…¥->å¾ˆå¤šå¾ˆå¤šå±‚->ç»“æœ  
ç”¨â€œå¾ˆå¤šå¾ˆå¤šå±‚â€ä»£æ›¿â€œç‰¹å¾æå–ï¼ˆMFCCï¼‰+åˆ†ç±»å™¨â€  

#### 2.2 ç½‘ç»œå¦‚ä½•è®¾è®¡&è®­ç»ƒ
è®¾è®¡ï¼šç½‘ç»œç»“æ„é•¿ä»€ä¹ˆæ ·å­ï¼Œç”±è¶…å‚æ•°å†³å®šï¼ˆhyperparametersï¼‰ï¼Œè®­ç»ƒè¿‡ç¨‹ä¸­ä¸å˜  
æŸå¤±å‡½æ•°ï¼šå®šä¹‰â€ç†æƒ³â€œå’Œâ€ç°å®â€œçš„å·®è·  
è®­ç»ƒï¼šå°†æ•°æ®å–‚ç»™å®šä¹‰å¥½ç½‘ç»œç»“æ„å’ŒæŸå¤±å‡½æ•°çš„ç¥ç»ç½‘ç»œå­¦ä¹ ï¼Œå­¦ä¹ è¿‡ç¨‹ä¸­å‚æ•°ï¼ˆweightï¼‰ä¸åœçš„å˜åŒ–ï¼Œç›´åˆ°æ”¶æ•›  
æ¢¯åº¦ï¼šå­¦ä¹ è¿‡ç¨‹ä¸­éœ€è¦èµ°çš„è·¯  
å­¦ä¹ ç‡ï¼šæ¯ä¸€æ­¥èµ°å¤šå¤§ã€‚æœ‰ä¸€ç³»åˆ—åŠ¨æ€è°ƒèŠ‚çš„æœºåˆ¶ï¼Œadamï¼Œrmspropï¼Œadagradï¼Œmomentumç­‰  
æ¿€æ´»å‡½æ•°ï¼šæ¯ä¸€ä¸ªç¥ç»å…ƒè¾“å…¥ä¸è¾“å‡ºçš„å…³ç³»ï¼Œäº§ç”Ÿéçº¿æ€§  

#### 2.3 æ•°æ®é‡å°æ€ä¹ˆåŠ
æ•°æ®å¢å¼ºï¼ˆdata augmentationï¼‰:åœ¨ä¸ç ´ååŸå§‹æ•°æ®çš„å‰æä¸‹å¢åŠ åŠ å™ªå£°ï¼Œå½“ä½œæ–°çš„æ ·æœ¬  
è¿ç§»å­¦ä¹ ï¼ˆtransfer learningï¼‰:ç”¨å…¶ä»–ä»»åŠ¡è®­ç»ƒå¥½çš„ç½‘ç»œå½“ä½œç‰¹å¾æå–å™¨ï¼Œå‰æå‡è®¾æ˜¯ä¸¤ä¸ªä»»åŠ¡çš„æ•°æ®æœ‰ç›¸ä¼¼æ€§  
éšæœºç½‘ç»œ:éšæœºåˆå§‹åŒ–çš„CNNå¯ä»¥è¾¾åˆ°ä¸é”™çš„ç‰¹å¾æå–æ•ˆæœï¼ˆæƒŠå‘†ğŸ¤¯äº†ï¼‰  

### 3. MUSIC INFORMATION RETRIEVAL

#### 3.1 MIRä»»åŠ¡
ä¸æ˜¯æ‰€æœ‰é—®é¢˜éƒ½èƒ½åªé éŸ³é¢‘ä¿¡å·è§£å†³ï¼Œåˆ†ç±»/æ ‡ç­¾ç­‰ä¿¡æ¯å¾ˆæœ‰ç”¨ã€‚  
å…³æ³¨ä¸¤ä¸ªç»´åº¦  
> ï¼ˆlabelçš„ï¼‰ä¸»è§‚åº¦: éŸ³é«˜/è°ƒæ€§/èŠ‚å¥/å’Œå£°æ˜¯å®¢è§‚çš„ï¼›é£æ ¼ï¼Œæƒ…ç»ªæ˜¯ä¸»è§‚çš„  
> æ—¶é—´è·¨åº¦: éŸ³é«˜/å’Œå£°åªè¦å¾ˆçŸ­çš„ç‰‡æ®µå°±å¯ä»¥åˆ¤æ–­ï¼›æƒ…ç»ª/è°ƒæ€§éœ€è¦æ¯”è¾ƒé•¿çš„æ—‹å¾‹æ‰èƒ½åˆ¤æ–­  

#### 3.2 éŸ³é¢‘ä¿¡å·è¡¨è¾¾
äºŒç»´2Dï¼šæ—¶é—´åŸŸ+é¢‘ç‡åŸŸ  
STFT(short-time fourier transform):  
Melé¢‘è°±:  
Constant-Q Transform (CQT):  
Chromagram:  

### 4. ç”¨äºMIRçš„æ·±åº¦ç½‘ç»œ

#### 4.1 DenseLayerå¦‚ä½•å®šä¹‰
äºŒç»´2Dï¼šæ—¶é—´åŸŸ+é¢‘ç‡åŸŸ  
N Number of channels of a 2D representationå£°é“æ•°  
F Frequency-axis length of a 2D representationé¢‘åŸŸç»´åº¦  
T Time-axis length of a 2D representationæ—¶åŸŸç»´åº¦  
H Height of a 2D convolution kernel (frequency-axis)é¢‘åŸŸå·ç§¯æ ¸ç»´åº¦  
W Width of a 2D convolution kernel (time-axis)æ—¶åŸŸå·ç§¯æ ¸ç»´åº¦  
V Number of hidden nodes of a layeréšè—èŠ‚ç‚¹æ•°  
L Number of layers of a networkç½‘ç»œå±‚æ•°  
æ¯ä¸€å±‚æœ‰è¾“å…¥å’Œè¾“å‡ºç»´åº¦Vinå’ŒVout

#### 4.2 DenseLayerç”¨äºMIR
åœ¨2Dæ•°æ®ï¼ˆæ—¶åŸŸ+é¢‘åŸŸè¡¨è¾¾ï¼‰ä¹‹ä¸Šä½¿ç”¨DenseLayerï¼Œå¯¹æ¯ä¸€å¸§åšéçº¿æ€§å˜æ¢ï¼Œè¿˜å¯ä»¥åˆ©ç”¨ç›¸é‚»å¸§ä½œä¸ºä¸Šä¸‹æ–‡ä¿¡æ¯  
DenseLayerä¸å…·æœ‰å¹³ç§»/æ”¾ç¼©ä¸å˜æ€§  

#### 4.3 ConvLayerå·ç§¯å±‚
$$
y^{j}=f\left(\sum_{k=0}^{K-1} \mathbf{W}^{j k} * x^{k}+b^{j}\right)
$$  
weight sharingå…±äº«æƒé‡:å·ç§¯æ ¸åœ¨è¾“å…¥æ ·æœ¬ä¸­â€œæ»‘åŠ¨â€ï¼Œå‡å°‘å‚æ•°é‡  
feature map: å·ç§¯æ ¸åœ¨æ¯ä¸€ä¸ªä½ç½®æ¿€æ´»å¾—åˆ°çš„è¾“å‡ºï¼Œç©ºé—´ä¸å˜æ€§  
pooling layer: å‡å°‘feature mapçš„å¤§å°ï¼Œä¸‹é‡‡æ ·
stacking: å¤šä¸ªå·ç§¯å±‚ä¸²è”ï¼Œæå–å¤æ‚ç‰¹å¾
kernel size: ä¸å®œè¿‡å°ï¼Œå­¦ä¸åˆ°ä¿¡æ¯ã€‚ä¹Ÿä¸åº”è¿‡å¤§ï¼Œç”¨å¤šä¸ªå°kernel stackingæ¯”ç”¨ä¸€ä¸ªå¤§kernelå¥½

#### 4.5 RecurrentLayerå¾ªç¯å±‚
$$
\begin{array}{c}{y_{t}=f_{o u t}\left(\mathbf{V} h_{t}\right)} \\ {h_{t}=f_{h}\left(\mathbf{U} x_{t}+\mathbf{W} h_{t-1}\right)}\end{array}
$$  
å’ŒHMMç±»ä¼¼ï¼Œè¾“å…¥çŠ¶æ€xå’Œä¹‹å‰çš„éšçŠ¶æ€ç”Ÿæˆæ–°çš„éšçŠ¶æ€ï¼ŒéšçŠ¶æ€æ¿€æ´»å¾—åˆ°æœ€ç»ˆè¾“å‡º  
å®é™…ä½¿ç”¨ä¸­ï¼Œå› ä¸ºRNNå­˜åœ¨æ¢¯åº¦æ¶ˆå¤±/çˆ†ç‚¸é—®é¢˜ï¼Œé€šè¿‡åŠ å…¥é—å¿˜æœºåˆ¶çš„GRU/LSTMè§£å†³  

#### 4.6 RecurrentLayerç”¨äºMIR
è¾“å…¥å’Œéšå±‚å…¨è”æ¥ï¼Œä¹Ÿå¯ä»¥ç”¨å…¨è”æ¥å±‚ä»£æ›¿  
RecurrentLayerå†…ä¸èƒ½ä½¿ç”¨å¹³ç§»ä¸å˜æ€§ï¼ŒRecurrentLayeré€‚ç”¨äºåºåˆ—ç‰¹å¾ï¼ˆä¸ºå•¥ï¼Ÿï¼‰ï¼Œæ¯”å¦‚MFCCæˆ–å·ç§¯å±‚è¾“å‡ºçš„feature map  
è¾“å‡ºå±‚çš„ç»´åº¦Vè¦è¶³å¤Ÿå¤§æ‰èƒ½ä¿ç•™è¶³å¤Ÿå¤šçš„ä¿¡æ¯  
è€ƒè™‘æ€§èƒ½ï¼šæ§åˆ¶RecurrentLayeré•¿åº¦  
ä¸åŒçš„é—®é¢˜è€ƒè™‘ç”¨ä¸åŒçš„ç»“æ„: many-to-many, many-to-one  
æœªæ¥çš„ä¿¡æ¯æœ‰ç”¨ï¼Œå¯ä»¥ç”¨bi-directional  

### 5. å®è·µç»éªŒ



